Notebook[{

Cell[CellGroupData[{
Cell["General initialization", "Section"],

Cell[CellGroupData[{

Cell["Package dependencies", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<RBSFA`\>\"", ",", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<Packages/RB-SFA.m\>\""}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "$RBSFAversion", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "$MachineName", "]"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"RB-SFA v2.1.1, Tue 11 Oct 2016 20:14:10\"\>"], "Print"],

Cell[BoxData["\<\"ocelote\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"$OutputDirectory", "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<../9-Nondipole-HHG/Figures/\>\""}]}], ";"}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Automatically save a copy with no output", "Subsection"],

Cell["To turn it on:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"NotebookEventActions", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<MenuCommand\>\"", ",", "\"\<Save\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NotebookSave", "[", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nb", ",", "tempfile", ",", "cleanfile"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tempfile", "=", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], ",", 
                "\"\<temp.nb\>\""}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cleanfile", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"FileNameJoin", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"DirectoryName", "[", "#", "]"}], ",", 
                  "\"\<Clean\>\"", ",", 
                  RowBox[{"StringReplace", "[", 
                   RowBox[{
                    RowBox[{"FileNameTake", "[", "#", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<.nb\>\"", "\[Rule]", "\"\< - clean.nb\>\""}],
                     "}"}]}], "]"}]}], "}"}], "]"}], "&"}], "[", 
              RowBox[{"NotebookFileName", "[", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"CopyFile", "[", 
             RowBox[{
              RowBox[{"NotebookFileName", "[", "]"}], ",", "tempfile"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"nb", "=", 
             RowBox[{"NotebookOpen", "[", 
              RowBox[{"tempfile", ",", 
               RowBox[{"Visible", "\[Rule]", "False"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"NotebookFind", "[", 
             RowBox[{
             "nb", ",", "\"\<Output\>\"", ",", "All", ",", "CellStyle"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"NotebookDelete", "[", "nb", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"NotebookSave", "[", 
             RowBox[{"nb", ",", "cleanfile"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"NotebookClose", "[", "nb", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Run", "[", 
             RowBox[{"\"\<sed -i 's/Visible->True/Visible->True/g' \>\"", ",", 
              RowBox[{"StringReplace", "[", 
               RowBox[{"cleanfile", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], ",", 
                  RowBox[{"\"\<\\\\\>\"", "\[Rule]", "\"\<\\\\\\\\\>\""}]}], 
                 "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"DeleteFile", "[", "tempfile", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input"],

Cell["To turn it off:", "Text"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"NotebookEventActions", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "]"}]], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specific initialization", "Section"],

Cell[CellGroupData[{

Cell["Initialization", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<EPToolbox`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RBSFA`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", "$RBSFAversion", "\[IndentingNewLine]", \
"$RBSFAcommit", "\[IndentingNewLine]", "$MachineName"}], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"RB-SFA v2.1.1, Tue 11 Oct 2016 20:14:10\"\>"], "Output"],

Cell[BoxData["\<\"\"\>"], "Output"],

Cell[BoxData["\<\"ocelote\"\>"], "Output"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell["Version and machine used for the main run.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{"$RBSFAversion", "\[IndentingNewLine]", "$RBSFAcommit", "\
\[IndentingNewLine]", "$MachineName"}], "Input"],

Cell[BoxData["\<\"RB-SFA v2.1.0, Wed 18 May 2016 12:13:17\"\>"], "Output"],

Cell[BoxData["\<\"commit a16382d25db2cf9d3fcd4229004e4aed28ad30ce\\nAuthor: \
Emilio Pisanty <pisanty@mbi-berlin.de>\\nDate:   Wed May 18 12:14:00 2016 \
+0200\\n    Added GetSaddlesFromSeeds to .m file.\\n    \\n    Also minor \
documentation improvement.\"\>"], "Output"],

Cell[BoxData["\<\"ramanujan\"\>"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rotating linear fields", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"rotatingLinearA", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"t", ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{"s", "\[Rule]", "1"}], "}"}]}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Theta]", "\[Rule]", 
                 RowBox[{"-", "\[Theta]"}]}], ",", 
                RowBox[{"s", "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"\[Phi]", "\[Rule]", 
                 RowBox[{"-", "\[Phi]"}]}]}], "}"}]}], ")"}]}], "]"}], "&"}], 
         "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           FractionBox["F", "\[Omega]"], 
           RowBox[{
            RowBox[{"(", GridBox[{
               {
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "0", 
                RowBox[{"-", 
                 RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
               {"0", "1", "0"},
               {
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "0", 
                RowBox[{"Cos", "[", "\[Theta]", "]"}]}
              }], ")"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"k", " ", "zz"}], "-", 
                RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], ",", 
              RowBox[{"s", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"k", " ", "zz"}], "-", 
                 RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}]}], 
              ",", "0"}], "}"}]}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"zz", "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", "x"}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "z"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotatingLinearGA", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"t", ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rotatingLinearA", "[", "t", "]"}], ",", "x"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rotatingLinearA", "[", "t", "]"}], ",", "y"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"rotatingLinearA", "[", "t", "]"}], ",", "z"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Building spectra", "Chapter"],

Cell[CellGroupData[{

Cell["Saving and Loading data", "Section"],

Cell[CellGroupData[{

Cell["Saving data", "Subsection"],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{
   RowBox[{
   "$OutputDirectory", "<>", "\"\<Figure 9F data - saddle points.txt\>\""}], 
   ",", "saddlePoints"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{
   RowBox[{
   "$OutputDirectory", "<>", 
    "\"\<Figure 9F data - SPA harmonic dipoles.txt\>\""}], ",", 
   "fullSpectrumData"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{
   RowBox[{
   "$OutputDirectory", "<>", 
    "\"\<Figure 9F data - UA harmonic dipoles.txt\>\""}], ",", 
   "fullUASpectrumData"}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading data", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", 
   RowBox[{"(", 
    RowBox[{
    "$OutputDirectory", "<>", "\"\<Figure 9F data - saddle points.txt\>\""}], 
    ")"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", 
   RowBox[{"(", 
    RowBox[{
    "$OutputDirectory", "<>", 
     "\"\<Figure 9F data - SPA harmonic dipoles.txt\>\""}], ")"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", 
   RowBox[{"(", 
    RowBox[{
    "$OutputDirectory", "<>", 
     "\"\<Figure 9F data - UA harmonic dipoles.txt\>\""}], ")"}]}], 
  ";"}]], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Action definitions", "Section"],

Cell[CellGroupData[{

Cell["Parameters", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mainParameters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"int", "\[Rule]", 
      RowBox[{"1", " ", 
       SuperscriptBox["10", "17"]}]}], ",", 
     RowBox[{"F", "\[Rule]", 
      RowBox[{
       SqrtBox[
        RowBox[{"int", "/", 
         SuperscriptBox["10", "14"]}]], "0.053"}]}], ",", 
     RowBox[{"k", "\[Rule]", 
      RowBox[{"\[Alpha]", " ", "\[Omega]"}]}], ",", 
     RowBox[{"\[Omega]", "\[Rule]", 
      RowBox[{"45.6", "/", "\[Lambda]"}]}], ",", 
     RowBox[{"\[Lambda]", "\[Rule]", "800"}], ",", 
     RowBox[{"\[Phi]", "\[Rule]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"z", "\[Rule]", "0"}], ",", 
     RowBox[{"Ip", "\[Rule]", 
      RowBox[{"getIonizationPotential", "[", 
       RowBox[{"\"\<Neon\>\"", ",", "6"}], "]"}]}]}], "}"}]}], ";"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Dipole action", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"prefactorP", "[", 
       RowBox[{"0", ",", "\[Theta]_"}], "]"}], ",", 
      RowBox[{"Sp", "[", 
       RowBox[{"0", ",", "\[Theta]_"}], "]"}]}], "}"}], "=", 
    RowBox[{"makeDipoleList", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"VectorPotential", "\[Rule]", "rotatingLinearA"}], ",", 
      RowBox[{"VectorPotentialGradient", "\[Rule]", "rotatingLinearGA"}], ",", 
      RowBox[{"FieldParameters", "\[Rule]", 
       RowBox[{"Join", "[", 
        RowBox[{"mainParameters", ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", "\[Rule]", "0"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"CarrierFrequency", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"\[Omega]", "//.", "mainParameters"}], ")"}]}], ",", 
      RowBox[{"IonizationPotential", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"Ip", "//.", "mainParameters"}], ")"}]}], ",", 
      RowBox[{"\[Epsilon]Correction", "\[Rule]", "0"}], "\[IndentingNewLine]",
       ",", 
      RowBox[{"DipoleTransitionMatrixElement", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"hydrogenicDTMERegularized", ",", "hydrogenicDTME"}], "}"}]}],
       "\[IndentingNewLine]", ",", 
      RowBox[{"Verbose", "\[Rule]", "3"}], ",", 
      RowBox[{"CheckNumericFields", "\[Rule]", "False"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"Simplifier", "\[Rule]", "Simplify"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"LeafCount", "[", 
    RowBox[{"Sp", "[", 
     RowBox[{"0", ",", "\[Theta]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.591555`", ",", "188"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Nondipole action, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", "0"}], TraditionalForm]]]
}], "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sp", "[", 
    RowBox[{"\[Alpha]\[Alpha]_", ",", "0"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]\[Alpha]", ",", "0"}], "]"}], ",", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]\[Alpha]", ",", "0"}], "]"}]}], "}"}], "=", 
      RowBox[{"makeDipoleList", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VectorPotential", "\[Rule]", "rotatingLinearA"}], ",", 
        RowBox[{"VectorPotentialGradient", "\[Rule]", "rotatingLinearGA"}], 
        ",", 
        RowBox[{"FieldParameters", "\[Rule]", 
         RowBox[{"Join", "[", 
          RowBox[{"mainParameters", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Alpha]", "\[Rule]", "\[Alpha]\[Alpha]"}], ",", 
             RowBox[{"\[Theta]", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"CarrierFrequency", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"\[Omega]", "//.", "mainParameters"}], ")"}]}], ",", 
        RowBox[{"IonizationPotential", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Ip", "//.", "mainParameters"}], ")"}]}], ",", 
        RowBox[{"\[Epsilon]Correction", "\[Rule]", "0"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"DipoleTransitionMatrixElement", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"hydrogenicDTMERegularized", ",", "hydrogenicDTME"}], 
          "}"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"Verbose", "\[Rule]", "3"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Simplifier", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"#", ",", 
               RowBox[{"TimeConstraint", "\[Rule]", "0.02"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Simplify", "::", "time"}], "}"}]}], "]"}], "&"}], 
          ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]\[Alpha]", ",", "0"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{"LeafCount", "[", 
   RowBox[{
    RowBox[{"Sp", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", "0"}], "]"}], "[", 
    RowBox[{"t", ",", "tt"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.313733`", ",", "3594"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Nondipole action, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "\[NotEqual]", "0"}], TraditionalForm]]]
}], "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sp", "[", 
   RowBox[{"\[Alpha]\[Alpha]_", ",", "\[Theta]\[Theta]_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]1", ",", "\[Theta]1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"prefactorP", "[", 
        RowBox[{"\[Alpha]1_", ",", "\[Theta]1_"}], "]"}], ",", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]1_", ",", "\[Theta]1_"}], "]"}]}], "}"}], "=", 
     RowBox[{"makeDipoleList", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"VectorPotential", "\[Rule]", "rotatingLinearA"}], ",", 
       RowBox[{"VectorPotentialGradient", "\[Rule]", "rotatingLinearGA"}], 
       ",", 
       RowBox[{"FieldParameters", "\[Rule]", 
        RowBox[{"Join", "[", 
         RowBox[{"mainParameters", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Alpha]", "\[Rule]", "\[Alpha]1"}], ",", 
            RowBox[{"\[Theta]", "\[Rule]", "\[Theta]1"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"CarrierFrequency", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"\[Omega]", "//.", "mainParameters"}], ")"}]}], ",", 
       RowBox[{"IonizationPotential", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"Ip", "//.", "mainParameters"}], ")"}]}], ",", 
       RowBox[{"\[Epsilon]Correction", "\[Rule]", "0"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"DipoleTransitionMatrixElement", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"hydrogenicDTMERegularized", ",", "hydrogenicDTME"}], 
         "}"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"Verbose", "\[Rule]", "3"}], ",", 
       RowBox[{"CheckNumericFields", "\[Rule]", "False"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Simplifier", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"#", ",", 
              RowBox[{"TimeConstraint", "\[Rule]", "0.01"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Simplify", "::", "time"}], "}"}]}], "]"}], "&"}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"LeafCount", "[", 
   RowBox[{
    RowBox[{"Sp", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", "\[Theta]"}], "]"}], "[", 
    RowBox[{"t", ",", "tt"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"LeafCount", "[", 
   RowBox[{
    RowBox[{"Sp", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", 
      RowBox[{"5", "\[Degree]"}]}], "]"}], "[", 
    RowBox[{"t", ",", "tt"}], "]"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.421854`", ",", "100681"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.016635`", ",", "32950"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial seeds calculation", "Section"],

Cell[CellGroupData[{

Cell["Getting the seeds", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "S", ",", "d2S", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]Range", "=", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Ceiling", "[", 
            RowBox[{
             RowBox[{"Ip", "+", 
              RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1.32", "Ip"}], "+", 
                RowBox[{"3.17", "U"}]}], ")"}], "+", 
              RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
           RowBox[{"0.05", "U"}]}], "]"}], ",", "\[Omega]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]Range", "=", 
       RowBox[{"Union", "[", "\[IndentingNewLine]", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"Ip", "+", 
               RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.32", "Ip"}], "+", 
                 RowBox[{"3.17", "U"}]}], ")"}], "+", 
               RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
            RowBox[{"0.05", "U"}]}], "]"}], ",", "\[Omega]"}], "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Length", "[", "\[CapitalOmega]Range", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"t", ",", "tt"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tt", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialSeeds", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"GetSaddlePoints", "[", 
        RowBox[{"\[CapitalOmega]Range", ",", "S", ",", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"0", "\[Degree]"}], "-", 
                 RowBox[{"0.8", "\[ImaginaryI]"}]}], "\[Omega]"], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{"450", "\[Degree]"}], "+", 
                 RowBox[{"0.8", "\[ImaginaryI]", " "}]}], "\[Omega]"]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "90"}], "\[Degree]"}], "-", 
                 RowBox[{"0.07", "\[ImaginaryI]"}]}], "\[Omega]"], ",", 
               FractionBox[
                RowBox[{
                 RowBox[{"0", "\[Degree]"}], "+", 
                 RowBox[{"0.8", "\[ImaginaryI]"}]}], "\[Omega]"]}], "}"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"180", "\[Degree]"}], "\[Omega]"], "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"0", "\[Degree]"}], "-", 
                  RowBox[{"0.8", "\[ImaginaryI]"}]}], "\[Omega]"]}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"180", "\[Degree]"}], "\[Omega]"], "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"450", "\[Degree]"}], "+", 
                  RowBox[{"0.8", "\[ImaginaryI]", " "}]}], "\[Omega]"]}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"180", "\[Degree]"}], "\[Omega]"], "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "90"}], "\[Degree]"}], "-", 
                  RowBox[{"0.07", "\[ImaginaryI]"}]}], "\[Omega]"]}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"180", "\[Degree]"}], "\[Omega]"], "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"0", "\[Degree]"}], "+", 
                  RowBox[{"0.8", "\[ImaginaryI]"}]}], "\[Omega]"]}]}], 
              "}"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"IndependentVariables", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<t\>\"", ",", "\"\<tt\>\""}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Tolerance", "\[Rule]", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], "/", "\[Omega]"}]}], ",", 
         RowBox[{"Seeds", "\[Rule]", "100"}], "\[IndentingNewLine]", ",", 
         RowBox[{"SelectionFunction", "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]", ",", "SS", ",", "\[CapitalOmega]"}], 
             "}"}], ",", 
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"d2S", "[", 
               RowBox[{"t", ",", 
                RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "]"}], "<", "0"}]}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"Jacobian", "\[Rule]", "FiniteDifference"}]}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell["Timing estimate for a full spectrum:", "Text"],

Cell[BoxData[
 RowBox[{
  FractionBox["2.06", 
   SuperscriptBox["60", "2"]], 
  RowBox[{"Length", "[", 
   RowBox[{"Range", "@@", 
    FractionBox[
     RowBox[{"\[CapitalOmega]Range", "\[LeftDoubleBracket]", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}], "0.057"]}], 
   "]"}]}]], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", "=", 
     RowBox[{"Compress", "[", "saddlePoints", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Restore\>\"", ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Set", "[", 
        RowBox[{"saddlePoints", ",", 
         RowBox[{"Uncompress", "[", "data", "]"}]}], "]"}], ";", 
       "saddlePoints", ";"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"initialSeeds", "[", 
    RowBox[{"0", ",", "0"}], "]"}]}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Global saddle-points map", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "saddles", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"saddlePoints", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "\[Tau]"}], ")"}]}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"saddles", "[", "\[CapitalOmega]", "]"}], 
                "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalOmega]", ",", 
               RowBox[{"Keys", "[", "saddles", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"\[Omega]", " ", "t"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"saddles", "[", "\[CapitalOmega]", "]"}], 
                "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalOmega]", ",", 
               RowBox[{"Keys", "[", "saddles", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
                    RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], "]"}], "\[IndentingNewLine]", 
               ",", 
               RowBox[{
                RowBox[{"saddles", "[", "\[CapitalOmega]", "]"}], 
                "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalOmega]", ",", 
               RowBox[{"Keys", "[", "saddles", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point classification", "Subsection"],

Cell[CellGroupData[{

Cell["Classified saddles using points-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"True", "||", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"10940", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"5340", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keyColour", "[", 
      RowBox[{"\"\<D\>\"", ",", "_"}], "]"}], "=", "Cyan"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saddlesPlot", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "\[Tau]"}], ")"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"+", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", 
                    RowBox[{"2", "\[Pi]"}]}], "]"}]}], "*)"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}], "@*", 
                   RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                    "List"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"selection", "[", 
                   RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
                "\[IndentingNewLine]", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[CapitalOmega]", ",", 
                 RowBox[{"Keys", "[", 
                  RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"index", ",", 
               RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}],
             "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
        ",", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"\[Omega]", " ", "t"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}], "@*", 
                  RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                   "List"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"selection", "[", 
                  RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
               "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", 
                RowBox[{"Keys", "[", 
                 RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"index", ",", 
              RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
                    RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                   "\[IndentingNewLine]", "]"}], "@*", 
                  RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                   "List"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"selection", "[", 
                  RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
               "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", 
                RowBox[{"Keys", "[", 
                 RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"index", ",", 
              RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Classified saddles using lines-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"True", "||", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"10940", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"5340", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Values", "[", "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"assoc", ",", "key"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", 
                   RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"Values", "[", "assoc", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"DeleteMissing", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Query", "[", "Transpose", "]"}], "[", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Apply", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"(", 
                    RowBox[{"t", "-", "\[Tau]"}], ")"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                   
                   RowBox[{"selection", "[", "index", "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
                 "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", 
             RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1200", "}"}], ",", 
            RowBox[{"{", "700", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Values", "[", "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"assoc", ",", "key"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", 
                   RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"Values", "[", "assoc", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"DeleteMissing", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Query", "[", "Transpose", "]"}], "[", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Apply", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"\[Omega]", " ", "t"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                   
                   RowBox[{"selection", "[", "index", "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
                 "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", 
             RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1200", "}"}], ",", 
            RowBox[{"{", "700", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Values", "[", "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"assoc", ",", "key"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Graphics", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", 
                   RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{"Values", "[", "assoc", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"DeleteMissing", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Query", "[", "Transpose", "]"}], "[", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Apply", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
                    RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"selection", "[", "index", "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
                 "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", 
             RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1200", "}"}], ",", 
            RowBox[{"{", "700", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Spectrum at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", " ", 
    SuperscriptBox["10", "17"]}], TraditionalForm]]],
 ", \[Theta]=0, dipole"
}], "Section"],

Cell[CellGroupData[{

Cell["Getting saddles", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "S", ",", "d2S", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]Range", "=", 
       RowBox[{"Union", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"Ip", "+", 
                RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1.32", "Ip"}], "+", 
                  RowBox[{"3.17", "U"}]}], ")"}], "+", 
                RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
             RowBox[{"1", "\[Omega]"}]}], "]"}], ",", "\[Omega]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], ",", 
             RowBox[{"12300", "\[Omega]"}], ",", "\[Omega]"}], "]"}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Length", "[", "\[CapitalOmega]Range", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"t", ",", "tt"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tt", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"saddlePoints", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"GetSaddlesFromSeeds", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"initialSeeds", "[", 
          RowBox[{"0", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
         "\[CapitalOmega]Range", "\[IndentingNewLine]", ",", "S", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Tolerance", "\[Rule]", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], "/", "\[Omega]"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"SelectionFunction", "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]", ",", "SS", ",", "\[CapitalOmega]"}], 
             "}"}], ",", 
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"d2S", "[", 
               RowBox[{"t", ",", 
                RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "]"}], "<", "0"}]}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"Jacobian", "\[Rule]", "FiniteDifference"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"RecalculateRoots", "\[Rule]", "False"}]}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", "=", 
     RowBox[{"Compress", "[", "saddlePoints", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Restore\>\"", ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Set", "[", 
        RowBox[{"saddlePoints", ",", 
         RowBox[{"Uncompress", "[", "data", "]"}]}], "]"}], ";", 
       "saddlePoints", ";"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"saddlePoints", "[", 
    RowBox[{"0", ",", "0"}], "]"}]}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Global saddle-points map", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"#", "-", 
           RowBox[{"Round", "[", 
            RowBox[{"#", ",", 
             RowBox[{"50", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
         RowBox[{"0.5", "\[Omega]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}], "||"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]"}]}], "*)"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                  RowBox[{"Point", "[", 
                   RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"saddles", "[", "\[CapitalOmega]", "]"}], 
              "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}]}], 
            "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]", ",", 
             RowBox[{"Keys", "[", "saddles", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
       "options", "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", 
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "\[Tau]"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point classification", "Subsection"],

Cell[CellGroupData[{

Cell["Classified saddles using points-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keyColour", "[", 
      RowBox[{"\"\<D\>\"", ",", "_"}], "]"}], "=", "Cyan"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", "options", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1200", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saddlesPlot", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"plotter", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
            RowBox[{"\[Omega]", 
             RowBox[{"(", 
              RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}],
             "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Classified saddles using lines-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Values", "[", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"assoc", ",", "key"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"keyColour", "[", 
                   RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                   "]"}], "/.", 
                  RowBox[{
                   RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}]}],
                  ",", 
                 RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Tooltip", "[", 
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"Values", "[", "assoc", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"DeleteMissing", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Query", "[", "Transpose", "]"}], "[", 
               "\[IndentingNewLine]", 
               RowBox[{"Apply", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                   RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}]}], "]"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"selection", "[", "index", "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
               "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"index", ",", 
           RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1200", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", 
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Watching the Hessian for branch cuts", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"50", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"10940", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"5340", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "900", "}"}], ",", 
          RowBox[{"{", "900", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"HessianRoot", "[", 
              RowBox[{"S", ",", "t", ",", "\[Tau]"}], "]"}]], "+", 
            RowBox[{"0.0001", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\!\(\*SqrtBox[\(\*SuperscriptBox[\(\[ImaginaryI]\), \(2\)]\
\\\ \*SubsuperscriptBox[\(\[PartialD]\), \({t, tt}\), \(2\)]S\)]\))\>\"", 
            ",", "\"\<Im(\!\(\*SqrtBox[\(\*SuperscriptBox[\(\[ImaginaryI]\), \
\(2\)]\\\ \*SubsuperscriptBox[\(\[PartialD]\), \({t, tt}\), \
\(2\)]S\)]\))\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Demonstrating the Stokes transitions", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "secondClassifierFunction", ",", "zoomPlot", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"True", "||"}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"250", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.5", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
          "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"secondClassifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<A1\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<A2\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<A3\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<B1\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<B2\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<B3\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<C1\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<C2\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<C3\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<D1\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<D2\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<D3\>\"", 
         ",", "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<A1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<A2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Blue"}], ",", 
          RowBox[{"2", "\[Rule]", "Black"}]}], "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<A3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<B1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<B2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Magenta"}], ",", 
          RowBox[{"2", "\[Rule]", "Red"}]}], "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<B3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<C1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Orange"}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}]}], 
         "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<C3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<D1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Purple"}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}]}], 
         "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<D3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "secondClassifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"transitions", ",", "\[IndentingNewLine]", 
       RowBox[{"zoomPlot", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "2"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
                    RowBox[{"Subtract", "[", "##", "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}], "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"t", ",", 
                    RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", " ", "t"}]}]}], 
                    "\[IndentingNewLine]", "]"}], "@@", "#"}], "&"}], ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "+", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0", " ", "0.05", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], 
                    FractionBox[
                    RowBox[{"3", "\[Pi]"}], "4"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Im", "[", "t", "]"}], "]"}]}]], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], "@@", 
                    RowBox[{"First", "[", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", 
                   RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"index", ",", 
                 RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{"GrayLevel", "[", "0.2", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "5"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "10"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "900", "}"}], ",", 
             RowBox[{"{", "900", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Re(\!\(\*SubscriptBox[\(S\), \(1\)]\)-\[CapitalOmega] \
\!\(\*SubscriptBox[\(t\), \(1\)]\))-Re(\!\(\*SubscriptBox[\(S\), \(2\)]\)-\
\[CapitalOmega] \!\(\*SubscriptBox[\(t\), \(2\)]\))\>\"", ",", 
             "\"\<Im(\!\(\*SubscriptBox[\(S\), \(1\)]\)-\[CapitalOmega] \
\!\(\*SubscriptBox[\(t\), \(1\)]\))-Im(\!\(\*SubscriptBox[\(S\), \(2\)]\)-\
\[CapitalOmega] \!\(\*SubscriptBox[\(t\), \(2\)]\))\>\""}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"zoomPlot", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], "\[Rule]", 
            RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.1", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
            RowBox[{"0.1", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "True"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bare Stokes transitions", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "secondClassifierFunction", ",", "zoomPlot", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"True", "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"||", 
           RowBox[{
            RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"10940", "\[Omega]"}]}], "||", 
           RowBox[{
            RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
          "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "transitions"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point spectrum, per trajectory", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "prefactor", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prefactor", "=", 
      RowBox[{"prefactorP", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"True", "||"}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"100", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"||", 
           RowBox[{
            RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"6000", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<C\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], "*)"}],
           "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
       RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spectrumPlotSPAtrajectories", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
     RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"spectrumData", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"Values", "@", 
         RowBox[{
          RowBox[{"Query", "[", "Transpose", "]"}], "[", 
          "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"index", "=", "\"\<A\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Association", "[", 
             RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", "#"}],
                     "]"}], "]"}], "&"}], "/@", 
                  RowBox[{"selection", "[", 
                   RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                 ")"}]}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"\[CapitalOmega]", ",", 
                 RowBox[{"Keys", "[", 
                  RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
              "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        SuperscriptBox["10", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "13"}], ",", 
           RowBox[{"-", "7"}]}], "}"}]]}], "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Red", "}"}], ",", 
          RowBox[{"{", "Green", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
       
       RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
          "\"\<Dipole acceleration\>\""}], "}"}]}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point per-pair spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"Round", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
             RowBox[{"0.0005", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"1.2", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<C\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Point", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "12"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
                    "]"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", "index",
                    ",", 
                   RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalOmega]", ",", 
               RowBox[{"Keys", "[", 
                RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", 
             RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
           "\"\<harmonic dipole\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point total spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotSPA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "13"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fullSpectrumData", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform Approximation per-pair spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "prefactor", ",", 
       "transitions", ",", "saddles", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prefactor", "=", 
       RowBox[{"prefactorP", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"saddles", "=", 
       RowBox[{"KeySelect", "[", 
        RowBox[{
         RowBox[{"KeySort", "[", 
          RowBox[{"saddlePoints", "[", 
           RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{"True", "||"}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}], 
          RowBox[{"(*", 
           RowBox[{"||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"classifierFunction", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", 
              RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"1.2", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
             "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"6.3", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", 
                RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
            "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sortingFunction", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"list", ",", 
         RowBox[{"SortBy", "[", 
          RowBox[{"list", ",", 
           RowBox[{"Function", "[", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "-", 
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                    "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Black", "\[Rule]", "Gray"}], ",", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], "\[Rule]", 
                    RowBox[{"Lighter", "[", "Green", "]"}]}]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "15"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "12"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"\[CapitalOmega]", ",", 
                 RowBox[{"Keys", "[", 
                  RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"index", ",", 
               RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "1.8"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
             "\"\<harmonic dipole\>\""}], "}"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "15"}], ",", 
                 RowBox[{"-", "5.6"}]}], "}"}]}], "}"}]}]}], "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"PlotRangeClipping", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform Approximation total spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{"Total", "[", 
                  RowBox[{"#", "\[LeftDoubleBracket]", 
                   RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                  "]"}], "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fullUASpectrumData", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Spectrum at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", " ", 
    SuperscriptBox["10", "17"]}], TraditionalForm]]],
 ", \[Theta]=0, nondipole"
}], "Section"],

Cell[CellGroupData[{

Cell["Getting saddles", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "S", ",", "d2S", ",", "seeds", ",", "startingSeeds", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]Range", "=", 
       RowBox[{"Union", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"Ip", "+", 
                 RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"1.32", "Ip"}], "+", 
                   RowBox[{"3.17", "U"}]}], ")"}], "+", 
                 RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
              RowBox[{"0.02", "U"}]}], "]"}], ",", "\[Omega]"}], "]"}], ","}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"Ip", "+", 
                RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1.32", "Ip"}], "+", 
                  RowBox[{"3.17", "U"}]}], ")"}], "+", 
                RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
             RowBox[{"1", "\[Omega]"}]}], "]"}], ",", "\[Omega]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"12200", "\[Omega]"}], ",", 
           RowBox[{"12300", "\[Omega]"}], ",", "\[Omega]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"5950", "\[Omega]"}], ",", 
           RowBox[{"6050", "\[Omega]"}], ",", "\[Omega]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Length", "[", "\[CapitalOmega]Range", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"t", ",", "tt"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tt", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"startingSeeds", "=", 
       RowBox[{"saddlePoints", "[", 
        RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"seeds", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"startingSeeds", ",", "\[IndentingNewLine]", 
           RowBox[{"Association", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalOmega]", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"180", "\[Degree]"}], "\[Omega]"], ",", "0"}], 
                    "}"}], "+", "#"}]}], "}"}]}], "&"}], "@", 
               RowBox[{"{", 
                RowBox[{
                 FractionBox["2.75", "\[Omega]"], ",", 
                 FractionBox[
                  RowBox[{"4.0", "-", 
                   RowBox[{"0.15", "\[ImaginaryI]"}]}], "\[Omega]"]}], 
                "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "startingSeeds", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"12200", "\[Omega]"}], "<", "#", "<", 
                    RowBox[{"12300", "\[Omega]"}]}], "&"}]}], "]"}]}], 
               "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Association", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalOmega]", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"180", "\[Degree]"}], "\[Omega]"], ",", "0"}], 
                    "}"}], "+", "#"}]}], "}"}]}], "&"}], "@", 
               RowBox[{"{", 
                RowBox[{
                 FractionBox["6.25", "\[Omega]"], ",", 
                 FractionBox[
                  RowBox[{"7.7", "-", 
                   RowBox[{"0.15", "\[ImaginaryI]"}]}], "\[Omega]"]}], 
                "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "startingSeeds", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"5960", "\[Omega]"}], "<", "#", "<", 
                    RowBox[{"5990", "\[Omega]"}]}], "&"}]}], "]"}]}], "}"}]}],
              "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Apply", "[", "Join", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"saddlePoints", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"GetSaddlesFromSeeds", "[", "\[IndentingNewLine]", 
        RowBox[{
        "seeds", ",", "\[CapitalOmega]Range", ",", "S", "\[IndentingNewLine]",
          ",", 
         RowBox[{"Tolerance", "\[Rule]", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], "/", "\[Omega]"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"SelectionFunction", "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]", ",", "SS", ",", "\[CapitalOmega]"}], 
             "}"}], ",", 
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"d2S", "[", 
               RowBox[{"t", ",", 
                RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "]"}], "<", "0"}]}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"Jacobian", "\[Rule]", "FiniteDifference"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"RecalculateRoots", "\[Rule]", "True"}]}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", "=", 
     RowBox[{"Compress", "[", "saddlePoints", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Restore\>\"", ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Set", "[", 
        RowBox[{"saddlePoints", ",", 
         RowBox[{"Uncompress", "[", "data", "]"}]}], "]"}], ";", 
       "saddlePoints", ";"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"saddlePoints", "[", 
    RowBox[{
     RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Global saddle-points map", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", "137"}]}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"#", "-", 
           RowBox[{"Round", "[", 
            RowBox[{"#", ",", 
             RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
         RowBox[{"0.5", "\[Omega]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}], "||"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]"}]}], "*)"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                  RowBox[{"Point", "[", 
                   RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"saddles", "[", "\[CapitalOmega]", "]"}], 
              "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}]}], 
            "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]", ",", 
             RowBox[{"Keys", "[", "saddles", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
       "options", "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", 
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "\[Tau]"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point classification", "Subsection"],

Cell[CellGroupData[{

Cell["Classified saddles using points-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", "137"}]}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12200", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6050", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<C\>\"", 
           ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keyColour", "[", 
      RowBox[{"\"\<D\>\"", ",", "_"}], "]"}], "=", "Cyan"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", "options", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1400", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saddlesPlot", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"plotter", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
            RowBox[{"\[Omega]", 
             RowBox[{"(", 
              RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}],
             "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"saddlesPlot", "[", 
      RowBox[{"0", ",", "0"}], "]"}], ",", 
     RowBox[{"saddlesPlot", "[", 
      RowBox[{
       RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "}"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<t' saddles at 800nm, \!\(\*SuperscriptBox[\(10\), \
\(17\)]\)W/\!\(\*SuperscriptBox[\(cm\), \(2\)]\), \
\!\(\*SuperscriptBox[\(Ne\), \(\(6\)\(+\)\)]\), with and without nondipole \
effects\>\""}]}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Classified saddles using lines-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Values", "[", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"assoc", ",", "key"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"keyColour", "[", 
                   RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                   "]"}], "/.", 
                  RowBox[{
                   RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}]}],
                  ",", 
                 RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Tooltip", "[", 
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"Values", "[", "assoc", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"DeleteMissing", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Query", "[", "Transpose", "]"}], "[", 
               "\[IndentingNewLine]", 
               RowBox[{"Apply", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                   RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}]}], "]"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"selection", "[", "index", "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
               "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"index", ",", 
           RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1200", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", 
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Watching the Hessian for branch cuts", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"50", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"10940", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"5340", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "900", "}"}], ",", 
          RowBox[{"{", "900", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"HessianRoot", "[", 
              RowBox[{"S", ",", "t", ",", "\[Tau]"}], "]"}]], "+", 
            RowBox[{"0.0001", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\!\(\*SqrtBox[\(\*SuperscriptBox[\(\[ImaginaryI]\), \(2\)]\
\\\ \*SubsuperscriptBox[\(\[PartialD]\), \({t, tt}\), \(2\)]S\)]\))\>\"", 
            ",", "\"\<Im(\!\(\*SqrtBox[\(\*SuperscriptBox[\(\[ImaginaryI]\), \
\(2\)]\\\ \*SubsuperscriptBox[\(\[PartialD]\), \({t, tt}\), \
\(2\)]S\)]\))\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Demonstrating the Stokes transitions", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "secondClassifierFunction", ",", "zoomPlot", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"True", "||"}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"250", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.5", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
          "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"secondClassifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<A1\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<A2\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<A3\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<B1\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<B2\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<B3\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<C1\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<C2\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<C3\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<D1\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<D2\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<D3\>\"", 
         ",", "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<A1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<A2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Blue"}], ",", 
          RowBox[{"2", "\[Rule]", "Black"}]}], "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<A3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<B1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<B2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Magenta"}], ",", 
          RowBox[{"2", "\[Rule]", "Red"}]}], "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<B3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<C1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Orange"}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}]}], 
         "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<C3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<D1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Purple"}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}]}], 
         "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<D3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "secondClassifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"transitions", ",", "\[IndentingNewLine]", 
       RowBox[{"zoomPlot", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "2"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
                    RowBox[{"Subtract", "[", "##", "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}], "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"t", ",", 
                    RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", " ", "t"}]}]}], 
                    "\[IndentingNewLine]", "]"}], "@@", "#"}], "&"}], ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "+", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0", " ", "0.05", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], 
                    FractionBox[
                    RowBox[{"3", "\[Pi]"}], "4"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Im", "[", "t", "]"}], "]"}]}]], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], "@@", 
                    RowBox[{"First", "[", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", 
                   RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"index", ",", 
                 RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{"GrayLevel", "[", "0.2", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "5"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "10"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "900", "}"}], ",", 
             RowBox[{"{", "900", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Re(\!\(\*SubscriptBox[\(S\), \(1\)]\)-\[CapitalOmega] \
\!\(\*SubscriptBox[\(t\), \(1\)]\))-Re(\!\(\*SubscriptBox[\(S\), \(2\)]\)-\
\[CapitalOmega] \!\(\*SubscriptBox[\(t\), \(2\)]\))\>\"", ",", 
             "\"\<Im(\!\(\*SubscriptBox[\(S\), \(1\)]\)-\[CapitalOmega] \
\!\(\*SubscriptBox[\(t\), \(1\)]\))-Im(\!\(\*SubscriptBox[\(S\), \(2\)]\)-\
\[CapitalOmega] \!\(\*SubscriptBox[\(t\), \(2\)]\))\>\""}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"zoomPlot", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], "\[Rule]", 
            RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.1", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
            RowBox[{"0.1", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "True"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bare Stokes transitions", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "secondClassifierFunction", ",", "zoomPlot", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"True", "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"||", 
           RowBox[{
            RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"10940", "\[Omega]"}]}], "||", 
           RowBox[{
            RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
          "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "transitions"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point spectrum, per trajectory", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "prefactor", ",", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", "137"}]}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prefactor", "=", 
      RowBox[{"prefactorP", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"True", "||"}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"100", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"||", 
           RowBox[{
            RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"6000", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
              RowBox[{"\[CapitalOmega]", "<", 
               RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<C\>\"", 
            ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"\[CapitalOmega]", "<", 
               RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<D\>\"", 
            ","}], "*)"}], "\[IndentingNewLine]", "True", ",", 
          "\"\<Discard\>\""}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
       RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spectrumPlotSPAtrajectories", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
     RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"spectrumData", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"Values", "@", 
         RowBox[{
          RowBox[{"Query", "[", "Transpose", "]"}], "[", 
          "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"index", "=", "\"\<A\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Association", "[", 
             RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", "#"}],
                     "]"}], "]"}], "&"}], "/@", 
                  RowBox[{"selection", "[", 
                   RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                 ")"}]}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"\[CapitalOmega]", ",", 
                 RowBox[{"Keys", "[", 
                  RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
              "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        SuperscriptBox["10", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "13"}], ",", 
           RowBox[{"-", "7"}]}], "}"}]]}], "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "Black", "}"}], ",", 
          RowBox[{"{", "Blue", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
          "\"\<Dipole acceleration\>\""}], "}"}]}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"spectrumPlotSPAtrajectories", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ",", 
    RowBox[{"spectrumPlotSPAtrajectories", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "}"}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point per-pair spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"Round", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
             RowBox[{"0.0005", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"1.2", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<C\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Point", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "12"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
                    "]"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", "index",
                    ",", 
                   RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalOmega]", ",", 
               RowBox[{"Keys", "[", 
                RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", 
             RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
           "\"\<harmonic dipole\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point total spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotSPA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "13"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fullSpectrumData", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Red", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "60"], "75.4", " ", "11"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fullSpectrumPlotSPA", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ",", 
    RowBox[{"fullSpectrumPlotSPA", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform Approximation per-pair spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "prefactor", ",", 
       "transitions", ",", "saddles", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prefactor", "=", 
       RowBox[{"prefactorP", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"saddles", "=", 
       RowBox[{"KeySelect", "[", 
        RowBox[{
         RowBox[{"KeySort", "[", 
          RowBox[{"saddlePoints", "[", 
           RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{"True", "||"}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}], 
          RowBox[{"(*", 
           RowBox[{"||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"classifierFunction", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", 
              RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"1.2", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
             "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"6.3", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", 
                RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
            "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sortingFunction", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"list", ",", 
         RowBox[{"SortBy", "[", 
          RowBox[{"list", ",", 
           RowBox[{"Function", "[", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "-", 
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                    "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Black", "\[Rule]", "Gray"}], ",", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], "\[Rule]", 
                    RowBox[{"Lighter", "[", "Green", "]"}]}]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "15"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "12"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"\[CapitalOmega]", ",", 
                 RowBox[{"Keys", "[", 
                  RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"index", ",", 
               RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "1.8"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
             "\"\<harmonic dipole\>\""}], "}"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "15"}], ",", 
                 RowBox[{"-", "5.6"}]}], "}"}]}], "}"}]}]}], "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"PlotRangeClipping", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform Approximation total spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], " ", "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 " ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fullUASpectrumData", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Red", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], " ", "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 " ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"fullUASpectrumData", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{"=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Red", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fullSpectrumPlotUA", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ",", 
    RowBox[{"fullSpectrumPlotUA", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Spectrum at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", " ", 
    SuperscriptBox["10", "17"]}], TraditionalForm]]],
 ", \[Theta]=2\[Degree], nondipole"
}], "Section"],

Cell[CellGroupData[{

Cell["Getting saddles", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "S", ",", "d2S", ",", "seeds", ",", "startingSeeds", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]Range", "=", 
       RowBox[{"Union", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{"Ip", "+", 
                RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
             RowBox[{"Ceiling", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1.32", "Ip"}], "+", 
                  RowBox[{"3.17", "U"}]}], ")"}], "+", 
                RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
             RowBox[{"1", "\[Omega]"}]}], "]"}], ",", "\[Omega]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Round", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{"Ip", "+", 
                  RowBox[{"0.1", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
               RowBox[{"Ceiling", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"1.32", "Ip"}], "+", 
                    RowBox[{"3.17", "U"}]}], ")"}], "+", 
                  RowBox[{"0.3", "U"}]}], ",", "\[Omega]"}], "]"}], ",", 
               RowBox[{"0.05", "U"}]}], "]"}], ",", "\[Omega]"}], "]"}], 
           ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"12200", "\[Omega]"}], ",", 
             RowBox[{"12300", "\[Omega]"}], ",", "\[Omega]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"5970", "\[Omega]"}], ",", 
             RowBox[{"6040", "\[Omega]"}], ",", "\[Omega]"}], "]"}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Length", "[", "\[CapitalOmega]Range", "]"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"t", ",", "tt"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"tt", ",", "2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"startingSeeds", "=", 
       RowBox[{"saddlePoints", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"seeds", "=", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"startingSeeds", ",", "\[IndentingNewLine]", 
           RowBox[{"Association", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalOmega]", "\[Rule]", 
                 RowBox[{"{", "#", 
                  RowBox[{"(*", 
                   RowBox[{",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"180", "\[Degree]"}], "\[Omega]"], ",", "0"}], 
                    "}"}], "+", "#"}]}], "*)"}], "}"}]}], "&"}], "@", 
               RowBox[{"{", 
                RowBox[{
                 FractionBox["6", "\[Omega]"], ",", 
                 FractionBox[
                  RowBox[{"4.15", "-", 
                   RowBox[{"0.23", "\[ImaginaryI]"}]}], "\[Omega]"]}], 
                "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[CapitalOmega]", ",", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "startingSeeds", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"12260", "\[Omega]"}], "<", "#", "<", 
                    RowBox[{"12280", "\[Omega]"}]}], "&"}]}], "]"}]}], 
               "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Association", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"180", "\[Degree]"}], "\[Omega]"], ",", "0"}], 
                    "}"}], "+", "#"}]}], "}"}]}], "&"}], "@", 
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox["6.25", "\[Omega]"], ",", 
                   FractionBox[
                    RowBox[{"7.7", "-", 
                    RowBox[{"0.15", "\[ImaginaryI]"}]}], "\[Omega]"]}], 
                  "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[CapitalOmega]", ",", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{"Keys", "[", "startingSeeds", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"5960", "\[Omega]"}], "<", "#", "<", 
                    RowBox[{"5990", "\[Omega]"}]}], "&"}]}], "]"}]}], "}"}]}],
                "]"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}], "}"}], 
         ",", 
         RowBox[{"Apply", "[", "Join", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"saddlePoints", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"GetSaddlesFromSeeds", "[", "\[IndentingNewLine]", 
        RowBox[{
        "seeds", ",", "\[CapitalOmega]Range", ",", "S", "\[IndentingNewLine]",
          ",", 
         RowBox[{"Tolerance", "\[Rule]", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], "/", "\[Omega]"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"SelectionFunction", "\[Rule]", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]", ",", "SS", ",", "\[CapitalOmega]"}], 
             "}"}], ",", 
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"d2S", "[", 
               RowBox[{"t", ",", 
                RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "]"}], "<", "0"}]}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"Jacobian", "\[Rule]", "FiniteDifference"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"RecalculateRoots", "\[Rule]", "True"}]}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\[IndentingNewLine]"], "Input"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", "=", 
     RowBox[{"Compress", "[", "saddlePoints", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Restore\>\"", ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Set", "[", 
        RowBox[{"saddlePoints", ",", 
         RowBox[{"Uncompress", "[", "data", "]"}]}], "]"}], ";", 
       "saddlePoints", ";"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"saddlePoints", "[", 
    RowBox[{
     RowBox[{"1", "/", "137"}], ",", 
     RowBox[{"2", "\[Degree]"}]}], "]"}]}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Global saddle-points map", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", "137"}]}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"#", "-", 
           RowBox[{"Round", "[", 
            RowBox[{"#", ",", 
             RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
         RowBox[{"0.5", "\[Omega]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}], "||"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]"}]}], "*)"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                  RowBox[{"Point", "[", 
                   RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    FractionBox[
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}], "\[Pi]"]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"saddles", "[", "\[CapitalOmega]", "]"}], 
              "\[LeftDoubleBracket]", "All", "\[RightDoubleBracket]"}]}], 
            "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalOmega]", ",", 
             RowBox[{"Keys", "[", "saddles", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]", ",", 
       "options", "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", 
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "\[Tau]"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point classification", "Subsection"],

Cell[CellGroupData[{

Cell["Classified saddles using points-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", "137"}]}], ",", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12200", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6050", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<C\>\"", 
           ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keyColour", "[", 
      RowBox[{"\"\<D\>\"", ",", "_"}], "]"}], "=", "Cyan"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", "options", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1400", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saddlesPlot", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"plotter", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
            RowBox[{"\[Omega]", 
             RowBox[{"(", 
              RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}],
             "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"1", "/", "137"}]}], ",", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12200", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6050", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<D\>\"", 
           ","}], "*)"}], "\[IndentingNewLine]", "True", ",", 
         "\"\<Discard\>\""}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keyColour", "[", 
      RowBox[{"\"\<D\>\"", ",", "_"}], "]"}], "=", "Cyan"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", "options", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1400", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"saddlesPlot2", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
        RowBox[{"plotter", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"\[Omega]", 
              RowBox[{"(", 
               RowBox[{"t", "-", "\[Tau]"}], ")"}]}], "-", "\[Pi]"}]}], "]"}],
           ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}],
             "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"saddlesPlot", "[", 
      RowBox[{"0", ",", "0"}], "]"}], ",", 
     RowBox[{"saddlesPlot", "[", 
      RowBox[{
       RowBox[{"1", "/", "137"}], ",", "0"}], "]"}], ",", 
     RowBox[{"saddlesPlot", "[", 
      RowBox[{
       RowBox[{"1", "/", "137"}], ",", 
       RowBox[{"2", "\[Degree]"}]}], "]"}], ",", 
     RowBox[{"saddlesPlot2", "[", 
      RowBox[{
       RowBox[{"1", "/", "137"}], ",", 
       RowBox[{"2", "\[Degree]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<t' saddles at 800nm, \!\(\*SuperscriptBox[\(10\), \
\(17\)]\)W/\!\(\*SuperscriptBox[\(cm\), \(2\)]\), \
\!\(\*SuperscriptBox[\(Ne\), \(\(6\)\(+\)\)]\), with and without nondipole \
effects, \[Theta]=0 and \[Theta]=2\[Degree], with both half-cycles for the \
latter.\>\""}]}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Classified saddles using lines-based map", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"20", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"12300", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"6000", "\[Omega]", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Values", "[", "\[IndentingNewLine]", 
          RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"assoc", ",", "key"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Graphics", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"keyColour", "[", 
                   RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                   "]"}], "/.", 
                  RowBox[{
                   RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}]}],
                  ",", 
                 RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Tooltip", "[", 
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"Values", "[", "assoc", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"index", ",", 
                    RowBox[{"key", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"DeleteMissing", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Query", "[", "Transpose", "]"}], "[", 
               "\[IndentingNewLine]", 
               RowBox[{"Apply", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                   RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}]}], "]"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"selection", "[", "index", "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", 
               "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"index", ",", 
           RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1200", "}"}], ",", 
          RowBox[{"{", "700", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Tally", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{"Length", ",", "selection", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", 
            RowBox[{"(", 
             RowBox[{"t", "-", "\[Tau]"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]tt)\>\"", ",", "\"\<Im(\[Omega]tt)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "\[Tau]"}], "+", " ", 
            RowBox[{"0.1", " ", "\[ImaginaryI]", " ", 
             FractionBox["1", "\[Pi]"], 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\[Omega]\[Tau])\>\"", ",", "\"\<Im(\[Omega]\[Tau])\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Watching the Hessian for branch cuts", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "plotter", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Omega]", ",", "Ip", ",", 
        SqrtBox[
         RowBox[{"2", "Ip"}]], ",", 
        FractionBox[
         SuperscriptBox["F", "2"], 
         RowBox[{"4", 
          SuperscriptBox["\[Omega]", "2"]}]], ",", 
        FractionBox[
         RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
      "mainParameters"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"S", "=", 
     RowBox[{"Sp", "[", 
      RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d2S", "[", 
      RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
      RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"saddles", "=", 
     RowBox[{"KeySelect", "[", 
      RowBox[{
       RowBox[{"KeySort", "[", 
        RowBox[{"saddlePoints", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
       RowBox[{"(*", 
        RowBox[{"True", "||"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "[", 
             RowBox[{"#", ",", 
              RowBox[{"50", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
          RowBox[{"0.5", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"10940", "\[Omega]"}]}], "||", 
         RowBox[{
          RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
          RowBox[{"5340", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"classifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.2", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
         "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sortingFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"list", ",", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list", ",", 
         RowBox[{"Function", "[", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "-", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"\"\<A\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<B\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"\"\<Bad\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Brown"}], ",", 
          RowBox[{"2", "\[Rule]", "Brown"}], ",", 
          RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plotter", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"n", ",", "t", ",", "\[Tau]"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "n"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"ReIm", "[", 
                    RowBox[{"f", "[", 
                    RowBox[{"t", ",", "\[Tau]"}], "]"}], "]"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", "n", ",", 
                    RowBox[{"\[Omega]", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}]}], ",", 
                    RowBox[{
                    FractionBox["1", "\[Pi]"], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], "@*", 
                RowBox[{"Apply", "[", "Sequence", "]"}], "@*", "Flatten", "@*",
                 "List"}], "\[IndentingNewLine]", ",", 
               RowBox[{"selection", "[", 
                RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], "]"}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[CapitalOmega]", ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"index", ",", 
            RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "900", "}"}], ",", 
          RowBox[{"{", "900", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"HessianRoot", "[", 
              RowBox[{"S", ",", "t", ",", "\[Tau]"}], "]"}]], "+", 
            RowBox[{"0.0001", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
              "]"}]}]}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Re(\!\(\*SqrtBox[\(\*SuperscriptBox[\(\[ImaginaryI]\), \(2\)]\
\\\ \*SubsuperscriptBox[\(\[PartialD]\), \({t, tt}\), \(2\)]S\)]\))\>\"", 
            ",", "\"\<Im(\!\(\*SqrtBox[\(\*SuperscriptBox[\(\[ImaginaryI]\), \
\(2\)]\\\ \*SubsuperscriptBox[\(\[PartialD]\), \({t, tt}\), \
\(2\)]S\)]\))\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"plotter", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
           RowBox[{"\[Omega]", " ", "t"}]}], "]"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<Re(\[Omega]t)\>\"", ",", "\"\<Im(\[Omega]t)\>\""}], 
           "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Demonstrating the Stokes transitions", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "secondClassifierFunction", ",", "zoomPlot", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"True", "||"}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"250", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.5", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"12300", "\[Omega]"}]}], "||", 
          RowBox[{
           RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
           RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
          "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"secondClassifierFunction", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<A1\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<A2\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"1.65", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<A\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<A3\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<B1\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<B2\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.65", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<B\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<B3\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{"\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<C1\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]", "<", 
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}],
             "]"}], ",", "\"\<C2\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"transitions", "\[LeftDoubleBracket]", 
               RowBox[{"\"\<C\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
              "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<C3\>\"",
            ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<D1\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "1"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]", "<", 
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
          "]"}], ",", "\"\<D2\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"6.3", "<", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], "]"}],
              "\[Pi]"], "\[Equal]", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"transitions", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<D\>\"", ",", "2"}], "\[RightDoubleBracket]"}], 
            "\[LessEqual]", "\[CapitalOmega]"}]}], "]"}], ",", "\"\<D3\>\"", 
         ",", "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"keyColour", "=", 
     RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<A1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       
       RowBox[{"\"\<A2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Blue"}], ",", 
          RowBox[{"2", "\[Rule]", "Black"}]}], "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<A3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Black"}], ",", 
          RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<B1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<B2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Magenta"}], ",", 
          RowBox[{"2", "\[Rule]", "Red"}]}], "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<B3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Red"}], ",", 
          RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<C1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<C2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Orange"}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}]}], 
         "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<C3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<D1\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
       ",", 
       RowBox[{"\"\<D2\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", "Purple"}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}]}], 
         "\[RightAssociation]"}]}], ",", 
       RowBox[{"\"\<D3\>\"", "\[Rule]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
          RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}]}], 
      "\[IndentingNewLine]", "\[RightAssociation]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "secondClassifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"transitions", ",", "\[IndentingNewLine]", 
       RowBox[{"zoomPlot", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", 
                    RowBox[{"index", ",", "2"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", 
                    "Gray"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"PointSize", "[", "0.005", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Tooltip", "[", 
                    RowBox[{
                    RowBox[{"Point", "[", 
                    RowBox[{"ReIm", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "##", "}"}], "]"}], "\[Equal]", "2"}], ",", 
                    RowBox[{"Subtract", "[", "##", "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}], "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"t", ",", 
                    RowBox[{"t", "-", "\[Tau]"}]}], "]"}], "-", 
                    RowBox[{"\[CapitalOmega]", " ", "t"}]}]}], 
                    "\[IndentingNewLine]", "]"}], "@@", "#"}], "&"}], ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "+", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "\[Tau]"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"0", " ", "0.05", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], 
                    FractionBox[
                    RowBox[{"3", "\[Pi]"}], "4"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{"Im", "[", "t", "]"}], "]"}]}]], 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"\[Tau]", "-", "t"}], "]"}]}], ",", "\[Pi]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], "@@", 
                    RowBox[{"First", "[", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", 
                   RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"index", ",", 
                 RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
             "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{"Thin", ",", 
               RowBox[{"GrayLevel", "[", "0.2", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "5"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "10"}], "}"}]}], "}"}], "]"}]}], "}"}], 
             "]"}]}], "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "900", "}"}], ",", 
             RowBox[{"{", "900", "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Re(\!\(\*SubscriptBox[\(S\), \(1\)]\)-\[CapitalOmega] \
\!\(\*SubscriptBox[\(t\), \(1\)]\))-Re(\!\(\*SubscriptBox[\(S\), \(2\)]\)-\
\[CapitalOmega] \!\(\*SubscriptBox[\(t\), \(2\)]\))\>\"", ",", 
             "\"\<Im(\!\(\*SubscriptBox[\(S\), \(1\)]\)-\[CapitalOmega] \
\!\(\*SubscriptBox[\(t\), \(1\)]\))-Im(\!\(\*SubscriptBox[\(S\), \(2\)]\)-\
\[CapitalOmega] \!\(\*SubscriptBox[\(t\), \(2\)]\))\>\""}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"zoomPlot", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "0.005", "]"}], "\[Rule]", 
            RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.1", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
            RowBox[{"0.1", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
         RowBox[{"PlotRangeClipping", "\[Rule]", "True"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bare Stokes transitions", "Subsection"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
     "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
     "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
     ",", "secondClassifierFunction", ",", "zoomPlot", ",", 
     RowBox[{"\[Alpha]", "=", "0"}], ",", 
     RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]", ",", "Ip", ",", 
         SqrtBox[
          RowBox[{"2", "Ip"}]], ",", 
         FractionBox[
          SuperscriptBox["F", "2"], 
          RowBox[{"4", 
           SuperscriptBox["\[Omega]", "2"]}]], ",", 
         FractionBox[
          RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
       "mainParameters"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Sp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2S", "[", 
       RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", 
         RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
       RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"saddles", "=", 
      RowBox[{"KeySelect", "[", 
       RowBox[{
        RowBox[{"KeySort", "[", 
         RowBox[{"saddlePoints", "[", 
          RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"True", "||", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"||", 
           RowBox[{
            RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"10940", "\[Omega]"}]}], "||", 
           RowBox[{
            RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
            RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"classifierFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"1.2", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<B\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"6.3", "<", 
             RowBox[{"\[Omega]", " ", 
              RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
               "]"}], "\[Pi]"], "\[Equal]", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ",", 
          "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"sortingFunction", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"list", ",", 
        RowBox[{"SortBy", "[", 
         RowBox[{"list", ",", 
          RowBox[{"Function", "[", 
           RowBox[{"Re", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "-", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"keyColour", "=", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<A\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Black"}], ",", 
           RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], ",", 
        RowBox[{"\"\<B\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Red"}], ",", 
           RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<C\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
           RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
        ",", 
        RowBox[{"\"\<Bad\>\"", "\[Rule]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "Brown"}], ",", 
           RowBox[{"2", "\[Rule]", "Brown"}], ",", 
           RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}], 
       "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"selection", "=", 
     RowBox[{"ClassifyQuantumOrbits", "[", 
      RowBox[{
      "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
       RowBox[{"DiscardedLabels", "\[Rule]", 
        RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transitions", "=", 
     RowBox[{"FindStokesTransitions", "[", 
      RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "transitions"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point spectrum, per trajectory", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeySort", "[", 
            RowBox[{"saddlePoints", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", ";;", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"Round", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"100", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
             RowBox[{"0.0005", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"1.2", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
                RowBox[{"\[CapitalOmega]", "<", 
                 RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<C\>\"", 
              ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"\[CapitalOmega]", "<", 
                 RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<D\>\"", 
              ","}], "*)"}], "\[IndentingNewLine]", "True", ",", 
            "\"\<Discard\>\""}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spectrumData", "[", 
           RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
          RowBox[{"Values", "@", 
           RowBox[{
            RowBox[{"Query", "[", "Transpose", "]"}], "[", 
            "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "\"\<A\>\""}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Association", "[", 
               RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", "#"}],
                     "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                   ")"}]}], "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", 
                   RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                  "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          SuperscriptBox["10", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "13"}], ",", 
             RowBox[{"-", "7"}]}], "}"}]]}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Darker", "[", "Green", "]"}], "}"}], ",", 
            RowBox[{"{", "Magenta", "}"}]}], "}"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Joined", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"saddles", "=", 
          RowBox[{"KeySelect", "[", 
           RowBox[{
            RowBox[{"KeySort", "[", 
             RowBox[{
              RowBox[{"saddlePoints", "[", 
               RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", ";;", "5"}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{"True", 
             RowBox[{"(*", 
              RowBox[{"||", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"#", "-", 
                  RowBox[{"Round", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"100", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
                RowBox[{"0.0005", "\[Omega]"}]}], "||", 
               RowBox[{
                RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
                RowBox[{"12300", "\[Omega]"}]}]}], "*)"}], 
             RowBox[{"(*", 
              RowBox[{"||", 
               RowBox[{
                RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
                RowBox[{"6000", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"KeySort", "[", 
            RowBox[{"saddlePoints", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", ";;", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"Round", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"100", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
             RowBox[{"0.0005", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"1.2", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", 
                RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ","}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}], ",", 
                RowBox[{"\[CapitalOmega]", "<", 
                 RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<C\>\"", 
              ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"\[CapitalOmega]", "<", 
                 RowBox[{"11500", "\[Omega]"}]}]}], "]"}], ",", "\"\<D\>\"", 
              ","}], "*)"}], "\[IndentingNewLine]", "True", ",", 
            "\"\<Discard\>\""}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]", ",", "\"\<B\>\""}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"spectrumData", "[", 
           RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
          RowBox[{"Values", "@", 
           RowBox[{
            RowBox[{"Query", "[", "Transpose", "]"}], "[", 
            "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"index", "=", "\"\<B\>\""}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Association", "[", 
               RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", "#"}],
                     "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                   ")"}]}], "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"\[CapitalOmega]", ",", 
                   RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                  "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          SuperscriptBox["10", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "13"}], ",", 
             RowBox[{"-", "7"}]}], "}"}]]}], "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Darker", "[", "Purple", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Darker", "[", "Cyan", "]"}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Joined", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}]], "Input"],

Cell[BoxData[
 RowBox[{"Legended", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{"0", ",", "0"}], "]"}], ",", 
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", "0"}], "]"}], ",", 
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", 
         RowBox[{"2", "\[Degree]"}]}], "]"}], ",", 
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", 
         RowBox[{"2", "\[Degree]"}], ",", "\"\<B\>\""}], "]"}]}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<\!\(\*SuperscriptBox[\(Ne\), \(\(6\)\(+\)\)]\) in a \
\!\(\*SuperscriptBox[\(10\), \(17\)]\)W/\!\(\*SuperscriptBox[\(cm\), \(2\)]\) \
field at 800nm.\>\""}]}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Red", ",", "\"\<Dipole, shorts\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Green", ",", "\"\<Dipole, longs\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "\"\<Nondipole \[Theta]=0, shorts\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", "\"\<Nondipole \[Theta]=0, longs\>\""}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Darker", "[", "Purple", "]"}], ",", 
        "\"\<Nondipole \[Theta]=2\[Degree], shorts 1\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
        "\"\<Nondipole \[Theta]=2\[Degree], longs 1\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Darker", "[", "Green", "]"}], ",", 
        "\"\<Nondipole \[Theta]=2\[Degree], shorts 2\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "Magenta", ",", "\"\<Nondipole \[Theta]=2\[Degree], longs 2\>\""}], 
       "}"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Legended", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{"0", ",", "0"}], "]"}], ",", 
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", "0"}], "]"}], ",", 
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", 
         RowBox[{"2", "\[Degree]"}]}], "]"}], ",", 
       RowBox[{"spectrumPlotSPAtrajectories", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", 
         RowBox[{"2", "\[Degree]"}], ",", "\"\<B\>\""}], "]"}]}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{
     "PlotLabel", "\[Rule]", 
      "\"\<\!\(\*SuperscriptBox[\(Ne\), \(\(6\)\(+\)\)]\) in a \
\!\(\*SuperscriptBox[\(10\), \(17\)]\)W/\!\(\*SuperscriptBox[\(cm\), \(2\)]\) \
field at 800nm.\>\""}]}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"Placed", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Red", ",", "\"\<Dipole, shorts\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Green", ",", "\"\<Dipole, longs\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "\"\<Nondipole \[Theta]=0, shorts\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", "\"\<Nondipole \[Theta]=0, longs\>\""}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "[", "Purple", "]"}], ",", 
          "\"\<Nondipole \[Theta]=2\[Degree], shorts 1\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "[", "Cyan", "]"}], ",", 
          "\"\<Nondipole \[Theta]=2\[Degree], longs 1\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "[", "Green", "]"}], ",", 
          "\"\<Nondipole \[Theta]=2\[Degree], shorts 2\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "Magenta", ",", "\"\<Nondipole \[Theta]=2\[Degree], longs 2\>\""}], 
         "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", "Below"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point per-pair spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"Round", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
             RowBox[{"0.0005", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"1.2", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"6.3", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<C\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Point", "[", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "12"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
                    "]"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", "index",
                    ",", 
                   RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[CapitalOmega]", ",", 
               RowBox[{"Keys", "[", 
                RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", 
             RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"1", "/", "2"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
           "\"\<harmonic dipole\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Saddle-point total spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotSPA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "13"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fullSpectrumData", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Red", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fullSpectrumPlotSPA", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ",", 
    RowBox[{"fullSpectrumPlotSPA", "[", 
     RowBox[{
      RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform Approximation per-pair spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "prefactor", ",", 
       "transitions", ",", "saddles", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Omega]", ",", "Ip", ",", 
          SqrtBox[
           RowBox[{"2", "Ip"}]], ",", 
          FractionBox[
           SuperscriptBox["F", "2"], 
           RowBox[{"4", 
            SuperscriptBox["\[Omega]", "2"]}]], ",", 
          FractionBox[
           RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
        "mainParameters"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Sp", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prefactor", "=", 
       RowBox[{"prefactorP", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2S", "[", 
        RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivative", "[", 
          RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
        RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"saddles", "=", 
       RowBox[{"KeySelect", "[", 
        RowBox[{
         RowBox[{"KeySort", "[", 
          RowBox[{"saddlePoints", "[", 
           RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{"True", "||"}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"#", "-", 
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", 
               RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
           RowBox[{"0.0005", "\[Omega]"}]}], 
          RowBox[{"(*", 
           RowBox[{"||", 
            RowBox[{
             RowBox[{"12150", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"12300", "\[Omega]"}]}], "||", 
            RowBox[{
             RowBox[{"5900", "\[Omega]"}], "<", "#", "<", 
             RowBox[{"6000", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"classifierFunction", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"1.2", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", 
              RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"1.2", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
             "\"\<B\>\"", ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"And", "[", 
            RowBox[{
             RowBox[{"6.3", "<", 
              RowBox[{"\[Omega]", " ", 
               RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", "\"\<C\>\"",
            ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{"6.3", "<", 
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
               RowBox[{
                FractionBox[
                 RowBox[{"Floor", "[", 
                  RowBox[{
                   RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                  "]"}], "\[Pi]"], "\[Equal]", 
                RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
            "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sortingFunction", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"list", ",", 
         RowBox[{"SortBy", "[", 
          RowBox[{"list", ",", 
           RowBox[{"Function", "[", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "-", 
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"\[Omega]", " ", 
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ParallelTable", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                    "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Black", "\[Rule]", "Gray"}], ",", 
                    RowBox[{
                    RowBox[{"Darker", "[", "Green", "]"}], "\[Rule]", 
                    RowBox[{"Lighter", "[", "Green", "]"}]}]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "15"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"SPAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"keyColour", "[", "index", "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Missing", "[", "__", "]"}], "\[Rule]", "Gray"}], 
                   "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Point", "[", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "12"}]], "+", 
                    RowBox[{"Norm", "[", "\[IndentingNewLine]", 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}], "}"}], 
                    "\[IndentingNewLine]", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalOmega]", "/", "\[Omega]"}], ",", 
                    "index", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"\[CapitalOmega]", ",", 
                 RowBox[{"Keys", "[", 
                  RowBox[{"selection", "[", "index", "]"}], "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"index", ",", 
               RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{"ImageSize", "\[Rule]", "1200"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "1.8"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
             "\"\<harmonic dipole\>\""}], "}"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "15"}], ",", 
                 RowBox[{"-", "5.6"}]}], "}"}]}], "}"}]}]}], "*)"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"PlotRangeClipping", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform Approximation total spectrum", "Subsection"],

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fullUASpectrumData", "[", 
             RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Green", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData[
 FractionBox["22940.", 
  SuperscriptBox["60", "2"]]], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DateString", "[", 
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "+", 
   RowBox[{"459.6", " ", 
    FractionBox["51", "21"]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"459.6", "/", "60"}]], "Input"],

Cell[BoxData[
 RowBox[{"combinedSpectra", "=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fullSpectrumPlotUA", "[", 
       RowBox[{"0", ",", "0"}], "]"}], ",", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", 
         RowBox[{"2", "\[Degree]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Darker", "[", 
         RowBox[{"Green", ",", "0.2"}], "]"}], "\[Rule]", "Blue"}]}], ",", 
      RowBox[{"fullSpectrumPlotUA", "[", 
       RowBox[{
        RowBox[{"1", "/", "137"}], ",", "0"}], "]"}]}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "12600"}], "}"}], ",", 
       RowBox[{"Log", "[", 
        SuperscriptBox["10", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "13.9"}], ",", 
           RowBox[{"-", "6.7"}]}], "}"}]], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "Automatic"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"None", ",", "Automatic"}], "}"}]}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Harmonic order\>\"", ",", "\"\<Harmonic intensity\>\""}], 
      "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "1.8"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", "#"], "]"}], ",", 
               RowBox[{"Superscript", "[", 
                RowBox[{"10", ",", "#"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.012", ",", "0"}], "}"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "14"}], ",", 
              RowBox[{"-", "6"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Outer", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   RowBox[{"#1", " ", 
                    SuperscriptBox["10", "#2"]}], "]"}], ",", "\"\<\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0.006", ",", "0"}], "}"}]}], "}"}], "&"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "9"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "14"}], ",", 
                 RowBox[{"-", "6"}]}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"NotebookSave", "[", "]"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculating and assembling the final plot", "Section"],

Cell[CellGroupData[{

Cell["Re-calculating each plot", "Subsection"],

Cell[CellGroupData[{

Cell["Dipole, \[Theta]=0", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", "0"}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"fullUASpectrumData", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{"=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Green", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\<\"Mon 22 Aug 2016 22:43:51\"\>"], "Output"],

Cell[BoxData["\<\"Mon 22 Aug 2016 22:43:59\"\>"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nondipole, \[Theta]=0", "Subsubsection"],

Cell[BoxData[
 RowBox[{"LaunchKernels", "[", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"fullUASpectrumData", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{"=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\<\"Mon 22 Aug 2016 22:44:40\"\>"], "Output"],

Cell[BoxData[
 TemplateBox[{
  "FindStokesTransitions","multipleAS",
   "\"FindStokesTransitions found multiple anti-Stokes transitions; using \\!\
\\(\\*RowBox[{\\\"Last\\\"}]\\) to return a single transition.\"",2,31,2,
   21824073830711890220,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData[
 TemplateBox[{
  "FindStokesTransitions","multipleAS",
   "\"FindStokesTransitions found multiple anti-Stokes transitions; using \\!\
\\(\\*RowBox[{\\\"Last\\\"}]\\) to return a single transition.\"",2,31,3,
   21824073830711890220,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData["\<\"Mon 22 Aug 2016 22:45:32\"\>"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nondipole, \[Theta]=2\[Degree]", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]", ",", 
       "selection", ",", "classifierFunction", ",", "sortingFunction", ",", 
       "keyColour", ",", "S", ",", "d2S", ",", "saddles", ",", "transitions", 
       ",", "prefactor", ",", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"1", "/", "137"}]}], ",", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"2", "\[Degree]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Omega]", ",", "Ip", ",", "\[Kappa]", ",", "U", ",", "\[Gamma]"}], 
         "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Ip", ",", 
           SqrtBox[
            RowBox[{"2", "Ip"}]], ",", 
           FractionBox[
            SuperscriptBox["F", "2"], 
            RowBox[{"4", 
             SuperscriptBox["\[Omega]", "2"]}]], ",", 
           FractionBox[
            RowBox[{"\[Kappa]", " ", "\[Omega]"}], "F"]}], "}"}], "//.", 
         "mainParameters"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Sp", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prefactor", "=", 
        RowBox[{"prefactorP", "[", 
         RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2S", "[", 
         RowBox[{"t_", ",", "tt_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2"}], "]"}], "[", "S", "]"}], "[", 
         RowBox[{"t", ",", "tt"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"saddles", "=", 
        RowBox[{"KeySelect", "[", 
         RowBox[{
          RowBox[{"KeySort", "[", 
           RowBox[{"saddlePoints", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"True", "||"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "-", 
              RowBox[{"Round", "[", 
               RowBox[{"#", ",", 
                RowBox[{"1", "\[Omega]"}]}], "]"}]}], "]"}], "<", 
            RowBox[{"0.0005", "\[Omega]"}]}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{
              RowBox[{"10921", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"10940", "\[Omega]"}]}], "||", 
             RowBox[{
              RowBox[{"5321", "\[Omega]"}], "<", "#", "<", 
              RowBox[{"5340", "\[Omega]"}]}]}], "*)"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"classifierFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[Tau]", ",", "\[CapitalOmega]"}], "}"}], ",", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<A\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"1.2", "<", 
               RowBox[{"\[Omega]", " ", 
                RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "6.3"}], ",", 
              RowBox[{
               FractionBox[
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", " ", 
                   RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                 "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
            "\"\<B\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", "0"}]}], "]"}], ",", 
              "\"\<C\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"And", "[", 
               RowBox[{
                RowBox[{"6.3", "<", 
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", "\[Tau]", "]"}]}], "<", "8.9"}], ",", 
                RowBox[{
                 FractionBox[
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"\[Omega]", " ", 
                    RowBox[{"Re", "[", 
                    RowBox[{"t", "-", "\[Tau]"}], "]"}]}], ",", "\[Pi]"}], 
                   "]"}], "\[Pi]"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], "]"}], ",", "\"\<D\>\"", ","}], 
             "*)"}], "\[IndentingNewLine]", "True", ",", "\"\<Discard\>\""}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sortingFunction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"list", ",", 
          RowBox[{"SortBy", "[", 
           RowBox[{"list", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"\[Omega]", " ", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "-", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"\[Omega]", " ", 
                  RowBox[{"Re", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
         "]"}]}], ";"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"keyColour", "=", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<A\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Black"}], ",", 
             RowBox[{"2", "\[Rule]", "Blue"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<B\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Red"}], ",", 
             RowBox[{"2", "\[Rule]", "Magenta"}]}], "\[RightAssociation]"}]}],
           ",", 
          RowBox[{"\"\<C\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Orange"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<D\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"Darker", "[", "Cyan", "]"}]}], ",", 
             RowBox[{"2", "\[Rule]", "Purple"}]}], "\[RightAssociation]"}]}], 
          ",", 
          RowBox[{"\"\<Bad\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "Brown"}], ",", 
             RowBox[{"2", "\[Rule]", "Brown"}], ",", 
             RowBox[{"3", "\[Rule]", "Brown"}]}], "\[RightAssociation]"}]}]}],
          "\[RightAssociation]"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"keyColour", "=", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<A\>\"", "\[Rule]", "Black"}], ",", 
         RowBox[{"\"\<B\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<C\>\"", "\[Rule]", 
          RowBox[{"Darker", "[", "Green", "]"}]}], ",", 
         RowBox[{"\"\<D\>\"", "\[Rule]", "Purple"}]}], 
        "\[RightAssociation]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"selection", "=", 
       RowBox[{"ClassifyQuantumOrbits", "[", 
        RowBox[{
        "saddles", ",", "classifierFunction", ",", "sortingFunction", ",", 
         RowBox[{"DiscardedLabels", "\[Rule]", 
          RowBox[{"{", "\"\<Discard\>\"", "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"transitions", "=", 
       RowBox[{"FindStokesTransitions", "[", 
        RowBox[{"S", ",", "selection"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}], "=", 
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
               "\[Omega]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Norm", "[", "  ", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
                   "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "\[RightDoubleBracket]"}], 
                 "  ", "]"}], "2"], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "14"}]]}]}], "\[IndentingNewLine]", "}"}], "&"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"fullUASpectrumData", "[", 
            RowBox[{"\[Alpha]", ",", "\[Theta]"}], "]"}]}], 
          RowBox[{"(*", 
           RowBox[{"=", 
            RowBox[{"GatherBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{
                    SuperscriptBox["\[CapitalOmega]", "2"], 
                    RowBox[{"UAdipole", "[", 
                    RowBox[{
                    "S", ",", "prefactor", ",", "\[CapitalOmega]", ",", 
                    RowBox[{"selection", "[", 
                    RowBox[{"index", ",", "\[CapitalOmega]"}], "]"}], ",", 
                    RowBox[{"transitions", "[", "index", "]"}]}], "]"}]}]}], 
                    "}"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[CapitalOmega]", ",", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"selection", "[", "index", "]"}], "]"}]}], 
                    "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"index", ",", 
                    RowBox[{"Keys", "[", "selection", "]"}]}], "}"}]}], "]"}],
                 "\[IndentingNewLine]", ",", "1"}], "]"}], ",", "First"}], 
             "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
         RowBox[{"GridLines", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Darker", "[", 
           RowBox[{"Green", ",", "0.2"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"ImageSize", "\[Rule]", "900"}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalOmega]/\[Omega]\>\"", ",", 
            "\"\<Dipole acceleration\>\""}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], 
  "//", "Column"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input"],

Cell[BoxData["\<\"Mon 22 Aug 2016 22:45:59\"\>"], "Output"],

Cell[BoxData[
 TemplateBox[{
  "FindStokesTransitions","multipleAS",
   "\"FindStokesTransitions found multiple anti-Stokes transitions; using \\!\
\\(\\*RowBox[{\\\"Last\\\"}]\\) to return a single transition.\"",2,34,4,
   21824073830711890220,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData["\<\"Mon 22 Aug 2016 22:54:33\"\>"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Combined spectra", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"combinedSpectra", "=", 
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{"0", ",", "0"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Darker", "[", 
         RowBox[{"Green", ",", "0.2"}], "]"}], "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.6", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"fullSpectrumPlotUA", "[", 
        RowBox[{
         RowBox[{"1", "/", "137"}], ",", 
         RowBox[{"2", "\[Degree]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"Darker", "[", 
         RowBox[{"Green", ",", "0.2"}], "]"}], "\[Rule]", "Blue"}]}], ",", 
      RowBox[{"fullSpectrumPlotUA", "[", 
       RowBox[{
        RowBox[{"1", "/", "137"}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
         RowBox[{"GrayLevel", "[", "0.05", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"4000", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"6", " ", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "8"}]]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"4000", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"1.1", " ", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "8"}]]}], "]"}]}], "}"}]}], "}"}], ",", "0"}], 
          "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<dipole\>\"", ",", "9", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"4000", ",", 
            RowBox[{"Log", "[", 
             RowBox[{"9", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "8"}]]}], "]"}]}], "}"}]}], "]"}], "}"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
         RowBox[{"GrayLevel", "[", "0.05", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2500", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"2.2", " ", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "10"}]]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2500", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"1.5", " ", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "9"}]]}], "]"}]}], "}"}]}], "}"}], ",", "0"}], 
          "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<nondipole, \[Theta]=2\[Degree]\>\"", ",", "9", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"2500", ",", 
            RowBox[{"Log", "[", 
             RowBox[{"1.5", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "10"}]]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.2"}], ",", "0"}], "}"}]}], "]"}], "}"}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
         RowBox[{"GrayLevel", "[", "0.05", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1500", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"2.5", " ", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "12"}]]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1500", ",", 
               RowBox[{"Log", "[", 
                RowBox[{"2.5", " ", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "11"}]]}], "]"}]}], "}"}]}], "}"}], ",", "0"}],
           "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<nondipole\>\"", ",", "9", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}]}], "]"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"1500", ",", 
            RowBox[{"Log", "[", 
             RowBox[{"1.5", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "12"}]]}], "]"}]}], "}"}]}], "]"}], "}"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "12600"}], "}"}], ",", 
       RowBox[{"Log", "[", 
        SuperscriptBox["10", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "13.9"}], ",", 
           RowBox[{"-", "6.7"}]}], "}"}]], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "Automatic"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"None", ",", "Automatic"}], "}"}]}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Harmonic order\>\"", ",", "\"\<Harmonic intensity\>\""}], 
      "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "1.8"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log", "[", 
                SuperscriptBox["10", "#"], "]"}], ",", 
               RowBox[{"Superscript", "[", 
                RowBox[{"10", ",", "#"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.012", ",", "0"}], "}"}]}], "}"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "14"}], ",", 
              RowBox[{"-", "6"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Outer", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   RowBox[{"#1", " ", 
                    SuperscriptBox["10", "#2"]}], "]"}], ",", "\"\<\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"0.006", ",", "0"}], "}"}]}], "}"}], "&"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "9"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "14"}], ",", 
                 RowBox[{"-", "6"}]}], "]"}]}], "]"}], ",", "1"}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FileByteCount", "[", 
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"$OutputDirectory", "<>", "\"\<figure9F.pdf\>\""}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "combinedSpectra", "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "340"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}]}]}], "]"}]}], "]"}], 
  "]"}]}], "Input"],

Cell[BoxData["2712815"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
NotebookAutoSave->False,
ClosingAutoSave->False,
ClosingSaveDialog->True,
CloseOnClickOutside->False,
IncludeFileExtension->True,
FileChangeProtection->Automatic,
TransitionEffect->Automatic,
TransitionDirection->Horizontal,
TransitionDuration->Short,
RasterExploreViewRange->17,
MarkerLineThickness->1.,
MarkerAspectRatio->0.,
AutoGeneratedPackage->None,
Editable->True,
Saveable->True,
StyleEnvironment->Automatic,
ScreenStyleEnvironment->"Working",
PrintingStyleEnvironment->"Printout",
ShowPageBreaks->False,
WindowToolbars->{},
RulerUnits->"Inches",
BlinkingCellInsertionPoint->True,
CellInsertionPointColor->GrayLevel[0.7500114442664225],
CellInsertionPointCell->FEPrivate`FrontEndResource[
 "FEExpressions", "CellInsertionMenu"],
EvaluationCompletionAction->{},
PrintAction->"PrintToNotebook",
OutputAutoOverwrite->True,
InitializationCellEvaluation->Automatic,
InitializationCellWarning->True,
NotebookEventActions->{{"MenuCommand", "Save"} :> (NotebookSave[]; 
   Block[{$CellContext`nb, $CellContext`tempfile, $CellContext`cleanfile}, \
$CellContext`tempfile = FileNameJoin[{
         NotebookDirectory[], "temp.nb"}]; $CellContext`cleanfile = (
       FileNameJoin[{
         DirectoryName[#], "Clean", 
         StringReplace[
          FileNameTake[#], {".nb" -> " - clean.nb"}]}]& )[
        NotebookFileName[]]; CopyFile[
       NotebookFileName[], $CellContext`tempfile]; $CellContext`nb = 
      NotebookOpen[$CellContext`tempfile, Visible -> False]; 
     NotebookFind[$CellContext`nb, "Output", All, CellStyle]; 
     NotebookDelete[$CellContext`nb]; 
     NotebookSave[$CellContext`nb, $CellContext`cleanfile]; 
     NotebookClose[$CellContext`nb]; 
     Run["sed -i 's/Visible->True/Visible->True/g' ", 
       StringReplace[$CellContext`cleanfile, {" " -> "\\ ", "\\" -> "\\\\"}]]; 
     DeleteFile[$CellContext`tempfile]; Null])},
NotebookDynamicExpression:>Null,
Selectable->True,
Clickable->True,
Deletable->True,
CellGrouping->Automatic,
PageWidth->WindowWidth,
WindowSize->{1861, 1176},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowFrame->"Normal",
WindowElements->{
 "StatusArea", "MemoryMonitor", "MagnificationPopUp", "HorizontalScrollBar", 
  "VerticalScrollBar", "MenuBar"},
WindowFrameElements->{
 "CloseBox", "ZoomBox", "MinimizeBox", "ToolbarBox", "DocumentIcon", 
  "ResizeArea"},
WindowFloating->Automatic,
WindowClickSelect->True,
WindowMovable->True,
WindowPersistentStyles->{
 WindowFrame, WindowMargins, WindowSize, DockedCells, Magnification},
BackgroundAppearance->None,
BackgroundAppearanceOptions->"Fill",
WindowTitle->Automatic,
WindowStatusArea->Automatic,
WindowOpacity->1.,
Visible->True,
DockedCells->{},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      Cell[
       TextData[{
         CounterBox["Page"]}], "PageNumber"], "   ", 
      Cell[
      " ", "Header", CellFrame -> {{0.5, 0}, {0, 0}}, CellFrameMargins -> 4], 
      
      Cell[
       TextData[{
         ValueBox["FileName"]}], "Header"]}], 
    CellMargins -> {{0, Inherited}, {Inherited, Inherited}}], None, None}, {
  None, None, 
   Cell[
    TextData[{
      Cell[
       TextData[{
         ValueBox["FileName"]}], "Header"], 
      Cell[
      " ", "Header", CellFrame -> {{0, 0.5}, {0, 0}}, CellFrameMargins -> 4], 
      "   ", 
      Cell[
       TextData[{
         CounterBox["Page"]}], "PageNumber"]}], 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}},
PageFooters->{{None, None, None}, {None, None, None}},
PageHeaderLines->{False, False},
PageFooterLines->{False, False},
PrivateNotebookOptions->{"DockedCellAnimation"->False,
"DockedCellTransition"->False,
"DocumentType"->Automatic,
"DoubleBuffer"->True,
"ExcludeFromShutdown"->False,
"FileContents"->{
 "FileLeader", "StandardFileLeader", "NotebookData", "StandardFileTrailer", 
  "FileTrailer"},
"FileLeader"->"",
"FileOutlineCache"->False,
"FileTrailer"->"",
"FinalWindowPrompt"->False,
"JournalStyle"->"Automatic",
"NoteStyle"->"Automatic",
"PluginToolbarEnabled"->True,
"PluginUpdateNotificationsEnabled"->True,
"SafeFileOpen"->"None",
"SafeFileSave"->"Prescan",
"VersionedStylesheet"->{}},
TrackCellChangeTimes->False,
Magnification->1.,
Background->None,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb",
GhostCellInEmptyNotebook -> False
]

